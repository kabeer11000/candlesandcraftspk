---
import BaseLayout from '@/layouts/BaseLayout.astro';
import ProductGrid from '@/components/ProductGrid.astro';
import productsData from '@/data/products.json';

// Re-use Product interface from other pages
interface ProductDetails { /* ... */ }
interface Product { /* ... */ }

const allProducts: Product[] = productsData;
const limitedProducts = allProducts.filter(p => p.isLimited);

// Define collections (could be more dynamic later)
const collections = [
    { name: "Limited Editions", slug: "limited-editions", products: limitedProducts },
    { name: "Writing Instruments", slug: "writing", products: allProducts.filter(p => p.category === "Writing Instruments") },
    { name: "Notebooks & Paper", slug: "paper", products: allProducts.filter(p => p.category === "Notebooks & Paper") },
    { name: "Desk Accessories", slug: "desk", products: allProducts.filter(p => p.category === "Desk Accessories") },
    { name: "The Full Collection", slug: "all", products: allProducts },
];
---
<BaseLayout title="Collections">
    <div class="container mx-auto px-4 py-16 md:py-24">
        <h1 class="text-4xl md:text-5xl font-bold font-serif text-center text-naksh-light mb-16 tracking-tight">Collections</h1>

        <div class="space-y-16 md:space-y-20">
            {collections.map(collection => (
                <section class="scroll-fade-in">
                    <h2 class="text-2xl md:text-3xl font-serif font-medium text-naksh-light mb-8 border-b border-naksh-medium/50 pb-3">
                        <a href={`/collections/${collection.slug}`} class="hover:text-naksh-blue transition-colors">
                            {collection.name}
                        </a> 
                        <span class="text-sm font-mono text-naksh-dim ml-2">({collection.products.length})</span>
                    </h2>
                    {collection.products.length > 0 ? (
                        <ProductGrid products={collection.products.slice(0, 3)} /> // Show first 3 as preview
                    ) : (
                        <p class="text-naksh-dim italic">No products currently in this collection.</p>
                    )}
                    {collection.products.length > 3 && (
                         <div class="text-center mt-8">
                             <a href={`/collections/${collection.slug}`} class="inline-block text-sm font-mono uppercase tracking-widest text-naksh-blue hover:text-blue-400 transition-colors group">
                                View All {collection.name} <span class="inline-block transition-transform duration-200 group-hover:translate-x-1">&rarr;</span>
                            </a>
                         </div>
                    )}
                </section>
            ))}
        </div>
    </div>
</BaseLayout>

<script>
  // Scroll animation script
   const animatedElements = document.querySelectorAll('.scroll-fade-in');
   const observer = new IntersectionObserver((entries) => {
     entries.forEach(entry => {
       if (entry.isIntersecting) { entry.target.classList.add('is-visible'); }
     });
  }, { threshold: 0.1 });
  animatedElements.forEach(el => { observer.observe(el); });
</script> 